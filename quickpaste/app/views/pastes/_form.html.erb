
<%= form_with model: paste do |f| %>
  <% if paste.errors.any? %>
    <div>
      <h3><%= t("errors.template.header", count: paste.errors.count) %></h3>
      <ul>
        <% paste.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="paste-body" data-controller="byte-counter" data-byte-counter-max-value="<%= Paste::MAX_QR_BYTES %>">
    <%= f.label :body, t("pastes.form.body_label") %>
    <span class="required-marker">*</span><br>
    <%= f.text_area :body, rows: 10, required: true, placeholder: t("pastes.form.body_placeholder"), data: { "byte-counter-target": "input", action: "input->byte-counter#update" } %>
    <div class="byte-counter" data-byte-counter-target="output" data-byte-counter-unit="<%= t("pastes.form.byte_unit") %>"></div>
  </div>

  <% if paste.new_record? %>
    <div>
      <%= f.label :tag, t("pastes.form.tag_label") %>
      <span class="required-marker">*</span><br>
      <%= f.text_field :tag, required: true, maxlength: 20, placeholder: t("pastes.form.tag_placeholder") %>
    </div>
  <% else %>
    <div>
      <strong><%= t("pastes.form.tag_label") %></strong><br>
      <%= paste.tag %>
    </div>
  <% end %>

  <div class="paste-options" data-controller="read-once">
    <div class="paste-option">
      <%= f.check_box :read_once, data: { "read-once-target": "readOnce", action: "read-once#toggleReadOnce" } %>
      <%= f.label :read_once, t("pastes.form.read_once_label") %>
    </div>

    <p class="paste-options-warning" data-read-once-target="warning" hidden>
      <%= t("pastes.form.read_once_warning") %>
    </p>

    <div class="paste-option">
      <%= check_box_tag :password_enabled, "1", paste.password_digest.present?, data: { "read-once-target": "passwordToggle", action: "read-once#togglePassword" } %>
      <%= label_tag :password_enabled do %>
        <%= t("pastes.form.password_option_label") %>
        <span class="paste-option-recommended" data-read-once-target="recommended" hidden><%= t("pastes.form.recommended") %></span>
      <% end %>
    </div>

    <div class="paste-password-fields" data-read-once-target="passwordFields">
      <%= f.label :password, t("pastes.form.password_label") %>
      <span class="required-marker" data-read-once-target="passwordRequiredMarker" hidden>*</span><br>
      <%= f.password_field :password, placeholder: t("pastes.form.password_placeholder"), data: { "read-once-target": "passwordInput" } %>

    </div>
  </div>

  <div>
    <%= f.submit(paste.new_record? ? t("common.actions.create") : t("common.actions.save")) %>
  </div>
<% end %>
